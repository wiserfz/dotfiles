# è§£é™¤é”®ç»‘å®š
unbind C-b
unbind C-z
unbind C-n

set -g prefix C-g                                               # é‡è®¾PREFIX
bind C-g send-prefix                                            # ç»‘å®š Ctrl+g ä¸ºæ–°çš„æŒ‡ä»¤å‰ç¼€
# å°† r é”®è®¾ç½®ä¸ºåŠ è½½é…ç½®æ–‡ä»¶ï¼Œå¹¶æ˜¾ç¤º"Configuration reloading..."ä¿¡æ¯
bind r source-file ~/.tmux.conf \; display "Configuration Reloading..."

bind -n M-n new-window -c "#{pane_current_path}"                # æ–°å»ºwindow
bind -n M-q previous-window                                     # ä¸Šä¸€ä¸ªwindow option-q
bind -n M-w next-window                                         # ä¸‹ä¸€ä¸ªwindow option-w
bind C-g setw synchronize-panes                                 # å¼€å¯/å…³é—­ pane åŒæ­¥æ¨¡å¼

setw -g mode-keys vi                                            # copy-modeå°†å¿«æ·é”®è®¾ç½®ä¸ºviæ¨¡å¼
set -g mouse on                                                 # é¼ æ ‡é»˜è®¤å¼€å¯
set -g repeat-time 600                                          # å¸¦-ræ ‡å¿—çš„é”®é‡å¤æ—¶é—´
set -g base-index 1                                             # çª—å£åºå·é»˜è®¤ä»1å¼€å§‹
set -g pane-base-index 1                                        # é¢æ¿åºå·ä»1å¼€å§‹
set -g history-limit 50000                                      # æ»šåŠ¨å†å²
set -g display-time 3000
set -g escape-time 0

# terminal
set -g default-terminal "xterm-256color"                        # è®¾ç½®256è‰²
set -sa terminal-overrides ',*:Smulx=\E[4::%p1%dm'              # undercurl support
set -sa terminal-overrides ',*:Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%;m'  # underscore colours - needs tmux-3.0

bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"
# é¼ æ ‡æ‹–åŠ¨é€‰ä¸­æ–‡æœ¬ï¼Œå¹¶å¤åˆ¶åˆ°Macç³»ç»Ÿç²˜è´´æ¿
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "pbcopy"

# pane é¢œè‰²
set -g pane-border-style fg="#373737"
set -g pane-active-border-style fg=blue

# message é¢œè‰²
set -g message-style fg=yellow,bg=black,bold

# è®¾ç½® status bar ä¸­çª—å£åˆ—è¡¨é¢œè‰²
setw -g window-status-current-style bold
setw -g window-status-current-format 'ğŸ¤”#[fg=red][\
#[fg=yellow]#{?pane_current_path,#{b:pane_current_path},#(basename $PWD)}\
#[fg=red]]'  # å½“å‰çª—å£
setw -g window-status-format         '  #[fg=cyan,bold][\
#[fg=gray]#{pane_current_command} \
#[fg=blue]#{?pane_current_path,#{b:pane_current_path},#(basename $PWD)}\
#[fg=cyan,bold]]'  # å…¶ä»–çª—å£

# è®¾ç½® status bar æ ¼å¼
set -g status-style default
set -g status-left-length 6
set -g status-left  "#[fg=black]#{?pane_synchronized,#[bg=yellow] S:#S ,#[fg=blue] S:#S }"
set -g status-right "#[fg=blue]%R "
set -g status-interval 60
set -g status-justify centre
setw -g monitor-activity on                                    # éå½“å‰çª—å£æœ‰å†…å®¹æ›´æ–°æ—¶åœ¨çŠ¶æ€æ é€šçŸ¥

# Kanagawa colors for Tmux
# set -g mode-style "fg=#658594,bg=#2D4F67"
#
# set -g message-style "fg=#efb61f,bg=#2D4F67"
# set -g message-command-style "fg=#658594,bg=#2D4F67"
#
# set -g pane-border-style "fg=#2D4F67"
# set -g pane-active-border-style "fg=#658594"
#
# set -g status "on"
# set -g status-justify "left"
#
# set -g status-style "fg=#658594,bg=#1F1F28"
#
# set -g status-left-length "100"
# set -g status-right-length "100"
#
# set -g status-left-style NONE
# set -g status-right-style NONE
#
# set -g status-left "#[fg=#16161D,bg=#658594,bold] #{?pane_synchronized,#[fg=#d1e4e4] S:#S , S:#S } #[fg=#658594,bg=#1F1F28,nobold,nounderscore,noitalics]î‚°"
# set -g status-right "#[fg=#1F1F28,bg=#1F1F28,nobold,nounderscore,noitalics]î‚²#[fg=#658594,bg=#1F1F28] #{prefix_highlight} #[fg=#2D4F67,bg=#1F1F28,nobold,nounderscore,noitalics]î‚²#[fg=#658594,bg=#2D4F67] %Y-%m-%d î‚³ %I:%M %p #[fg=#658594,bg=#2D4F67,nobold,nounderscore,noitalics]î‚²#[fg=#16161D,bg=#658594,bold] #h "
# if-shell '[ "$(tmux show-option -gqv "clock-mode-style")" == "24" ]' {
#     set -g status-right "#[fg=#1F1F28,bg=#1F1F28,nobold,nounderscore,noitalics]î‚²#[fg=#658594,bg=#1F1F28] #{prefix_highlight} #[fg=#2D4F67,bg=#1F1F28,nobold,nounderscore,noitalics]î‚²#[fg=#658594,bg=#2D4F67] %Y-%m-%d î‚³ %H:%M #[fg=#658594,bg=#2D4F67,nobold,nounderscore,noitalics]î‚²#[fg=#16161D,bg=#658594,bold] #h "
# }
#
# setw -g window-status-activity-style "underscore,fg=#7FB4CA,bg=#1F1F28"
# setw -g window-status-separator ""
# setw -g window-status-style "NONE,fg=#7FB4CA,bg=#1F1F28"
# setw -g window-status-format "#[fg=#1F1F28,bg=#1F1F28,nobold,nounderscore,noitalics]î‚°#[default] #I î‚± #(basename '#{pane_current_path}')#[fg=#1F1F28,bg=#1F1F28,nobold,nounderscore,noitalics]î‚°"
# setw -g window-status-current-format "#[fg=#1F1F28,bg=#2D4F67,nobold,nounderscore,noitalics]î‚°#[fg=#658594,bg=#2D4F67,bold] ğŸ¤” î‚± #(basename '#{pane_current_path}')#[fg=#2D4F67,bg=#1F1F28,nobold,nounderscore,noitalics]î‚°"

# åˆ†å‰²çª—å£
unbind '"'
bind - splitw -v -c "#{pane_current_path}"                     # åˆ†å‰²æˆä¸Šä¸‹ä¸¤ä¸ªçª—å£
unbind %
bind | splitw -h -c "#{pane_current_path}"                     # åˆ†å‰²æˆå·¦å³ä¸¤ä¸ªçª—å£
bind -r Space next-layout                                      # é€‰æ‹©ä¸‹ä¸€ä¸ªå¸ƒå±€

# é€‰æ‹© pane
# bind -r k       select-pane -U
# bind -r j       select-pane -D
# bind -r h       select-pane -L
# bind -r l       select-pane -R

# å°å¹…è°ƒæ•´ pane å¤§å°
bind -r K       resize-pane -U 1
bind -r J       resize-pane -D 1
bind -r H       resize-pane -L 2
bind -r L       resize-pane -R 2

# å¤§å¹…è°ƒæ•´ pane å¤§å°
bind -r Up      resize-pane -U 5
bind -r Down    resize-pane -D 5
bind -r Left    resize-pane -L 10
bind -r Right   resize-pane -R 10

# å¼€å¯windowäº‹ä»¶æç¤º
setw -g monitor-activity on
set -g visual-activity off

# å…³é—­é»˜è®¤çš„ rename æœºåˆ¶
setw -g automatic-rename off
setw -g allow-rename off

set-environment -g PATH "/opt/homebrew/bin:/usr/local/bin:/bin:/usr/bin"

# æ’ä»¶ç®¡ç†
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'

set -g @plugin 'christoomey/vim-tmux-navigator' # for navigating panes and vim/nvim with Ctrl-hjkl
# set -g @plugin 'tmux-plugins/tmux-resurrect' # persist tmux sessions after computer restart
# set -g @plugin 'tmux-plugins/tmux-continuum' # automatically saves sessions for you every 15 minutes

# set -g @resurrect-capture-pane-contents 'on' # allow tmux-ressurect to capture pane contents
# set -g @continuum-restore 'on' # enable tmux-continuum functionality

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
